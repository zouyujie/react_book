"use strict";!function(t,e,a,i){t.init();var n=function(e){return a.getElementById(e)},r={question:n("question"),contact:n("contact"),imageList:n("image-list"),submit:n("submit"),clearForm:function(){r.question.value="",r.contact.value="",r.imageList.innerHTML="",r.newPlaceholder()},getFileInputArray:function(){return[].slice.call(r.imageList.querySelectorAll('input[type="file"]'))},getFileInputIdArray:function(){var e=r.getFileInputArray(),t=[];return e.forEach(function(e){""!=e.value&&t.push(e.getAttribute("id"))}),t}},c=0;r.newPlaceholder=function(){var e=r.getFileInputArray();if(!(e&&0<e.length&&e[e.length-1].parentNode.classList.contains("space"))){c++;var i=a.createElement("div");i.setAttribute("class","image-item space");var t=a.createElement("div");t.setAttribute("class","image-close"),t.innerHTML="X",t.addEventListener("click",function(e){return e.stopPropagation(),e.cancelBubble=!0,setTimeout(function(){r.imageList.removeChild(i)},0),!1},!1);var n=a.createElement("input");n.setAttribute("type","file"),n.setAttribute("accept","image/*"),n.setAttribute("id","image-"+c),n.addEventListener("change",function(e){var t=n.files[0];if(t){var a=new FileReader;a.onload=function(){var e="data:image/png;base64,"+a.result.split(",")[1];i.style.backgroundImage="url("+e+")"},a.readAsDataURL(t),i.classList.remove("space"),r.newPlaceholder()}},!1),i.appendChild(t),i.appendChild(n),r.imageList.appendChild(i)}},r.newPlaceholder(),r.submit.addEventListener("tap",function(e){if(""==r.question.value||""!=r.contact.value&&0!=r.contact.value.search(/^(\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+)|([1-9]\d{4,9})$/))return t.toast("信息填写不符合规范");plus.nativeUI.showWaiting(),feedback.send({question:r.question.value,contact:r.contact.value,images:r.getFileInputIdArray()},function(){plus.nativeUI.closeWaiting(),t.toast("感谢您的建议~"),r.clearForm(),t.back()})},!1)}(mui,window,document);