"use strict";!function(o,r){r.login=function(e,t){return t=t||o.noop,(e=e||{}).account=e.account||"",e.password=e.password||"",e.account.length<5?t("账号最短为 5 个字符"):e.password.length<6?t("密码最短为 6 个字符"):JSON.parse(localStorage.getItem("$users")||"[]").some(function(t){return e.account==t.account&&e.password==t.password})?r.createState(e.account,t):t("用户名或密码错误")},r.createState=function(t,e){var n=r.getState();return n.account=t,n.token="token123456789",r.setState(n),e()},r.reg=function(t,e){if(e=e||o.noop,(t=t||{}).account=t.account||"",t.password=t.password||"",t.account.length<5)return e("用户名最短需要 5 个字符");if(t.password.length<6)return e("密码最短需要 6 个字符");if(!a(t.email))return e("邮箱地址不合法");var n=JSON.parse(localStorage.getItem("$users")||"[]");return n.push(t),localStorage.setItem("$users",JSON.stringify(n)),e()},r.getState=function(){var t=localStorage.getItem("$state")||"{}";return JSON.parse(t)},r.setState=function(t){t=t||{},localStorage.setItem("$state",JSON.stringify(t))};var a=function(t){return 3<(t=t||"").length&&-1<t.indexOf("@")};r.forgetPassword=function(t,e){return e=e||o.noop,a(t)?e(null,"新的随机密码已经发送到您的邮箱，请查收邮件。"):e("邮箱地址不合法")},r.setSettings=function(t){t=t||{},localStorage.setItem("$settings",JSON.stringify(t))},r.getSettings=function(){var t=localStorage.getItem("$settings")||"{}";return JSON.parse(t)},r.isInstalled=function(t){if("qihoo"===t&&mui.os.plus)return!0;if(mui.os.android){var e=plus.android.runtimeMainActivity().getPackageManager(),n=plus.android.importClass(e);try{return e.getPackageInfo({qq:"com.tencent.mobileqq",weixin:"com.tencent.mm",sinaweibo:"com.sina.weibo"}[t],n.GET_ACTIVITIES)}catch(t){}}else switch(t){case"qq":return plus.ios.import("TencentOAuth").iphoneQQInstalled();case"weixin":return plus.ios.import("WXApi").isWXAppInstalled();case"sinaweibo":return plus.ios.import("WeiboSDK").isWeiboAppInstalled()}}}(mui,window.app={});